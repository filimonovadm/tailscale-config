# Конфигурация сети Tailscale

Этот репозиторий управляет конфигурацией сети Tailscale с помощью подхода "Конфигурация как код" (GitOps).

## Как это работает

Любые изменения в файл `policy.hujson`, отправленные в ветку `main`, автоматически запускают рабочий процесс GitHub Actions (`.github/workflows/tailscale.yml`).

Этот процесс:
1.  Аутентифицируется в Tailscale API с помощью OAuth-клиента (секреты хранятся в GitHub Secrets).
2.  Проверяет синтаксис и логику файла политики.
3.  Если проверка прошла успешно, применяет новую конфигурацию ко всей сети Tailscale.

Редактирование политик в веб-интерфейсе Tailscale заблокировано, чтобы гарантировать, что Git является единственным источником правды.

## Структура репозитория

*   `README.md`: Этот файл с описанием проекта.
*   `policy.hujson`: Основной файл политики, который определяет все правила доступа, группы, хосты и правила SSH.
*   `.github/workflows/tailscale.yml`: Файл рабочего процесса GitHub Actions, который выполняет автоматизацию.

---

## Описание сетевой конфигурации

### Exit Node

В качестве Exit Node используется виртуальная машина в Google Cloud. Это позволяет устройствам в сети выходить в интернет через IP-адрес этого сервера. На машине были выполнены следующие настройки:

*   Установлен Tailscale и запущен с флагом `--advertise-exit-node`.
*   Включена пересылка IP-пакетов в ядре Linux (`net.ipv4.ip_forward=1`).
*   В админ-панели Tailscale разрешено использование этого устройства в качестве `exit node`.
